<!DOCTYPE html> <html lang="EN"> <head> <meta charset="utf-8"> <title>Lichat Tcp Client</title> <style>html body{margin:0 auto 0 auto;padding:20px;max-width:1024px;font-family:sans-serif;font-size:14pt;overflow-y:scroll;}html body a{text-decoration:none;}html body a[href]{color:#0055AA;}html body a[href]:hover{color:#0088EE;}html body pre{background:#FAFAFA;border:1px solid #DDDDDD;padding:0.75em;overflow-x:auto;}html body pre >code a[href]{color:#223388;}article.project h1{font-size:1.7em;}article.project h1,article.project h2,article.project h3,article.project h4,article.project h5,article.project h6{margin:0.2em 0 0.1em 0;text-indent:1em;}article.project >header{text-align:center;}article.project >header img.logo{display:block;margin:auto;max-height:170px;}article.project >header h1{display:inline-block;text-indent:0;font-size:2.5em;}article.project >header .version{vertical-align:bottom;}article.project >header .languages{margin-top:-0.5em;text-transform:capitalize;}article.project >header .description{margin:0;}article.project >header .pages{margin-top:0.5em;font-size:1.2em;text-transform:capitalize;}article.project >header .pages a{display:inline-block;padding:0 0.2em;}article.project >section{margin:1em 0 1em 0;}article.project >section img{max-width:100%;}article.project #index >ul{list-style:none;margin:0;padding:0;}article.project .row label{display:inline-block;min-width:8em;}article.project #system .row{display:flex;}article.project #system #dependencies{display:inline;margin:0;padding:0;}article.project #system #dependencies li{display:inline;padding:0 0.2em;}article.project #system #author label{vertical-align:top;}article.project #system #author ul{display:inline-block;margin:0;padding:0;list-style:none;}article.project #toc nav>*{margin-left:1em;display:block;}article.definition{margin:1em 0 0 0;}article.definition >header h1,article.definition >header h2,article.definition >header h3,article.definition >header h4,article.definition >header h5,article.definition >header h6{text-indent:0;display:inline-block;}article.definition >header ul{display:inline-block;list-style:none;margin:0;padding:0;}article.definition >header ul li{display:inline-block;padding:0 0.2em 0 0;}article.definition >header .visibility{display:none;}article.definition >header .visibility,article.definition >header .type{text-transform:lowercase;}article.definition >header .source-link{visibility:hidden;float:right;}article.definition >header .source-link:after{visibility:visible;content:"[SRC]";}article.definition .docstring{margin:0 0 0 1em;}article.definition .docstring pre{font-size:0.8em;white-space:pre-wrap;}.definition.package >header ul.nicknames{display:inline-block;list-style:none;margin:0;padding:0 0 0 1em;}.definition.package >header ul.nicknames li{display:inline;}.definition.package >header ul.nicknames:before{content:"(";}.definition.package >header ul.nicknames:after{content:")";}.definition.package ul.definitions{margin:0;list-style:none;padding:0 0 0 0.5em;}.definition.callable >header .name:before,.definition.type >header .name:before{content:"(";font-weight:normal;}.definition.callable >header .arguments:after,.definition.type >header .arguments:after{content:")";}.definition.callable >header .arguments .arguments:before,.definition.type >header .arguments .arguments:before{content:"(";}.definition.callable >header .arguments .argument,.definition.type >header .arguments .argument{padding:0;}.definition.callable >header .arguments .argument.lambda-list-keyword,.definition.type >header .arguments .argument.lambda-list-keyword{color:#991155;}.definition li>mark{background:none;border-left:0.3em solid #0088EE;padding-left:0.3em;display:block;}@media (min-width: 1300px){html body{padding-left:16em;}article.project #toc{margin:0;position:fixed;left:0;top:0;bottom:0;width:15em;overflow-y:auto;background:#F0F0F0;border-right:1px solid #A0A0A0;}}</style> </head> <body> <article class="project"> <header>   <h1>lichat tcp client</h1>   <span class="version">1.0.0</span>    <p class="description">A simple TCP client implementation for lichat</p>   </header> <section id="toc"> <h2>Table of Contents</h2> <nav> <a href="#project">Top</a>  <a href="#documentation">Documentation</a> <nav> <a href="#about_lichat-tcp-client">About Lichat-TCP-Client</a>  <a href="#how_to">How To</a>  <a href="#mini_client">Mini Client</a>  <a href="#also_see">Also See</a> </nav>  <a href="#system">System</a>  <a href="#system">Packages</a> <nav> <a href="#PACKAGE%20LICHAT-TCP-CLIENT">LICHAT-TCP-CLIENT</a> </nav>  </nav> </section>  <section id="documentation"><h2 id="about_lichat-tcp-client">About Lichat-TCP-Client</h2> <p>This is a simple, threaded, TCP-based client for the <a href="https://shirakumo.org/projects/lichat-protocol">Lichat protocol</a>.</p> <h2 id="how_to">How To</h2> <p>Create a new client instance and pass it whatever settings you would like.</p> <pre><code>(<a href="http://l1sp.org/cl/defvar" class="xref">defvar</a> *client* (<a href="http://l1sp.org/cl/make-instance" class="xref">make-instance</a> <a href="#CLASS%20LICHAT-TCP-CLIENT%3ACLIENT" class="xref">'lichat-tcp-client:client</a>))</code></pre> <p>Notable initargs of potential interest are:</p> <ul> <li><code>:username</code> The name the client goes by on the network. Defaults to <code>(machine-instance)</code>.</li> <li><code>:password</code> The password of the user profile, if any. Defaults to <code>NIL</code>.</li> <li><code>:hostname</code> The hostname to which the TCP socket should connect. The default is <code>localhost</code>.</li> <li><code>:port</code> The port the TCP socket should connect to. The default is <code>1111</code>.</li> </ul> <p>Once a client exists, it can be started to attempt a connection to the server.</p> <pre><code>(<a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AOPEN-CONNECTION" class="xref">lichat-tcp-client:open-connection</a> *client*)</code></pre> <p>The client logs information via <a href="http://shinmera.github.io/verbose/">Verbose</a>. If you set the REPL level to <code>:trace</code> you should see a bunch of status messages being printed every now and again.</p> <p>Once you're done with the client, you can shut it down again.</p> <pre><code>(<a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ACLOSE-CONNECTION" class="xref">lichat-tcp-client:close-connection</a> *client*)</code></pre> <p>Naturally this client doesn't really do much on its own. You can send updates to the server with <code><a href="#FUNCTION%20LICHAT-TCP-CLIENT%3AS" class="xref">s</a></code>:</p> <pre><code>(<a href="#FUNCTION%20LICHAT-TCP-CLIENT%3AS" class="xref">lichat-tcp-client:s</a> *client* 'create :channel &quot;test&quot;)
(<a href="#FUNCTION%20LICHAT-TCP-CLIENT%3AS" class="xref">lichat-tcp-client:s</a> *client* 'message :channel &quot;test&quot; :text &quot;Hey.&quot;)</code></pre> <p>If you would like to respond to updates that the server sends back, you can define a method on <code><a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3APROCESS" class="xref">process</a></code> to do so.</p> <pre><code>(<a href="http://l1sp.org/cl/defmethod" class="xref">defmethod</a> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3APROCESS" class="xref">lichat-tcp-client:process</a> ((update <a href="https://Shirakumo.github.io/lichat-protocol/#CLASS%20LICHAT-PROTOCOL%3AJOIN" class="xref">lichat-protocol:join</a>) (client <a href="#CLASS%20LICHAT-TCP-CLIENT%3ACLIENT" class="xref">lichat-tcp-client:client</a>))
  (<a href="#FUNCTION%20LICHAT-TCP-CLIENT%3AS" class="xref">lichat-tcp-client:s</a> client 'message
                       :channel (<a href="https://Shirakumo.github.io/lichat-protocol/#GENERIC-FUNCTION%20LICHAT-PROTOCOL%3ACHANNEL" class="xref">lichat-protocol:channel</a> update)
                       :text &quot;What's up everyone?&quot;))</code></pre> <p>See the <a href="https://shirakumo.org/projects/lichat-protocol">Lichat protocol</a> for more information on the available updates, their arguments, and their behaviour.</p> <h2 id="mini_client">Mini Client</h2> <p>You can also try a minimal sample client by calling <code><a href="#FUNCTION%20LICHAT-TCP-CLIENT%3AMINI-CLIENT" class="xref">mini-client</a></code>. The client is meant to illustrate simple use of the library, so make sure to check out its source file, <code>mini.lisp</code>.</p> <h2 id="also_see">Also See</h2> <ul> <li><a href="https://shirakumo.github.io/lichat-protocol">lichat-protocol</a> The Lichat protocol specification.</li> <li><a href="https://shirakumo.github.io/lichat-serverlib">lichat-serverlib</a> An agnostic implementation of the server-side protocol.</li> <li><a href="https://shirakumo.github.io/lichat-tcp-server">lichat-tcp-server</a> A basic, threaded, TCP-based implementation of a Lichat server.</li> <li><a href="https://github.com/Shirakumo/lionchat">LionChat</a> A Qt GUI client for a TCP server.</li> </ul> </section>    <section id="system"> <h2>System Information</h2>  <div class="row"> <label for="version">Version:</label> <a id="version">1.0.0</a> </div>   <div class="row"> <label for="dependencies">Dependencies:</label> <ul id="dependencies"><li><a class="external" href="https://Shirakumo.github.io/lichat-protocol/">lichat-protocol</a></li><li><a class="external">usocket</a></li><li><a class="external">bordeaux-threads</a></li><li><a class="external" href="https://Shinmera.github.io/documentation-utils/">documentation-utils</a></li><li><a class="external" href="https://Shinmera.github.io/verbose/">verbose</a></li><li><a class="external">cl-base64</a></li><li><a class="external" href="https://Shinmera.github.io/trivial-mimes/">trivial-mimes</a></li></ul> </div>   <div class="row" id="author"> <label for="author">Author:</label> <a href="mailto:shinmera@tymoon.eu">Yukari Hafner</a> </div>   <div class="row"> <label for="license">License:</label> <a id="license" href="https://github.com/Shirakumo/lichat-tcp-client/blob/5343d37e71c48fe2db6885200bb3599822012d19/LICENSE">zlib</a> </div>   <div class="row"> <label for="homepage">Homepage:</label> <a id="homepage" href="https://Shirakumo.github.io/lichat-tcp-client/">https://Shirakumo.github.io/lichat-tcp-client/</a> </div>   <div class="row"> <label for="bug-tracker">Bug Tracker:</label> <a id="bug-tracker" href="https://github.com/Shirakumo/lichat-tcp-client/issues">https://github.com/Shirakumo/lichat-tcp-client/issues</a> </div>   <div class="row"> <label for="sources">Sources:</label> <a id="sources" href="https://github.com/Shirakumo/lichat-tcp-client.git">https://github.com/Shirakumo/lichat-tcp-client.git</a> </div>  </section>    <section id="index"> <h2>Definition Index</h2> <ul> <li> <article class="definition package" id="PACKAGE LICHAT-TCP-CLIENT"> <header> <h3> <a href="#PACKAGE%20LICHAT-TCP-CLIENT">LICHAT-TCP-CLIENT</a> </h3> <ul class="nicknames"> <li>ORG.SHIRAKUMO.LICHAT.TCP-CLIENT</li> </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> <ul class="definitions"> <li> <article class="definition special-variable" id="VARIABLE LICHAT-TCP-CLIENT:*DEFAULT-PORT*"> <header> <span class="visibility">EXTERNAL</span> <span class="type">SPECIAL-VARIABLE</span> <h4 class="name"> <a href="#VARIABLE%20LICHAT-TCP-CLIENT%3A%2ADEFAULT-PORT%2A">*DEFAULT-PORT*</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/lichat-tcp-client/blob/5343d37e71c48fe2db6885200bb3599822012d19/client.lisp#L3">Source</a>  </header> <div class="docstring"><pre>The default TCP port on which to connect. Should be 1111.</pre></div> </article> </li>  <li> <article class="definition class" id="CLASS LICHAT-TCP-CLIENT:CLIENT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20LICHAT-TCP-CLIENT%3ACLIENT">CLIENT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/lichat-tcp-client/blob/5343d37e71c48fe2db6885200bb3599822012d19/client.lisp#L5">Source</a>  </header> <div class="docstring"><pre>Class to represent a Lichat client.

See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AUSERNAME" class="xref">USERNAME</a>
See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3APASSWORD" class="xref">PASSWORD</a>
See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AHOSTNAME" class="xref">HOSTNAME</a>
See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3APORT" class="xref">PORT</a>
See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ASOCKET" class="xref">SOCKET</a>
See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ATHREAD" class="xref">THREAD</a></pre></div> </article> </li>  <li> <article class="definition class" id="CLASS LICHAT-TCP-CLIENT:MINI-CLIENT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">CLASS</span> <h4 class="name"> <a href="#CLASS%20LICHAT-TCP-CLIENT%3AMINI-CLIENT">MINI-CLIENT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments"></ul>  <a class="source-link" href="https://github.com/Shirakumo/lichat-tcp-client/blob/5343d37e71c48fe2db6885200bb3599822012d19/mini.lisp#L3">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION LICHAT-TCP-CLIENT:MINI-CLIENT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20LICHAT-TCP-CLIENT%3AMINI-CLIENT">MINI-CLIENT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument lambda-list-keyword">&amp;KEY</li>    <li class="argument">USERNAME</li>    <li class="argument">PASSWORD</li>    <li class="argument">HOSTNAME</li>    <li class="argument">PORT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/lichat-tcp-client/blob/5343d37e71c48fe2db6885200bb3599822012d19/mini.lisp#L54">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION LICHAT-TCP-CLIENT:S"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20LICHAT-TCP-CLIENT%3AS">S</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CLIENT</li>    <li class="argument">TYPE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>    <li class="argument">ARGS</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/lichat-tcp-client/blob/5343d37e71c48fe2db6885200bb3599822012d19/client.lisp#L97">Source</a>  </header> <div class="docstring"><pre>Shorthand to construct an update to the server.

TYPE is coerced to a symbol from the LICHAT-PROTOCOL package.
It is then used together with the initargs to create an update
instance. A :FROM initarg using the client's USERNAME is
automatically added.

See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ASEND" class="xref">SEND</a></pre></div> </article> </li>  <li> <article class="definition function callable" id="FUNCTION LICHAT-TCP-CLIENT:S-DATA"> <header> <span class="visibility">EXTERNAL</span> <span class="type">FUNCTION</span> <h4 class="name"> <a href="#FUNCTION%20LICHAT-TCP-CLIENT%3AS-DATA">S-DATA</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CLIENT</li>    <li class="argument">CHANNEL</li>    <li class="argument">FILE</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/lichat-tcp-client/blob/5343d37e71c48fe2db6885200bb3599822012d19/client.lisp#L105">Source</a>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:CALL-WITH-RESPONSE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ACALL-WITH-RESPONSE">CALL-WITH-RESPONSE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">FUNCTION</li>    <li class="argument">CLIENT</li>    <li class="argument">INIT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Calls the function once a suitable response update has appeared on the client's stream.

A suitable response is either an UPDATE with the same ID
as the update returned by INIT, or an UPDATE-FAILURE with
the same UPDATE-ID as the ID of the updated returned by
INIT. If another message is found that does not match, it
is simply ignored.

See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AREAD-MESSAGE" class="xref">READ-MESSAGE</a>
See <a href="https://Shirakumo.github.io/lichat-protocol/#CLASS%20LICHAT-PROTOCOL%3AUPDATE-FAILURE" class="xref">LICHAT-PROTOCOL:UPDATE-FAILURE</a>
See <a href="https://Shirakumo.github.io/lichat-protocol/#GENERIC-FUNCTION%20LICHAT-PROTOCOL%3AUPDATE" class="xref">LICHAT-PROTOCOL:UPDATE</a>
See <a href="https://Shirakumo.github.io/lichat-protocol/#GENERIC-FUNCTION%20LICHAT-PROTOCOL%3AID" class="xref">LICHAT-PROTOCOL:ID</a>
See <a href="https://Shirakumo.github.io/lichat-protocol/#GENERIC-FUNCTION%20LICHAT-PROTOCOL%3AUPDATE-ID" class="xref">LICHAT-PROTOCOL:UPDATE-ID</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:CLOSE-CONNECTION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ACLOSE-CONNECTION">CLOSE-CONNECTION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CLIENT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Closes the connection to the server.

Attempts to be graceful by first sending a 
LICHAT-PROTOCOL:DISCONNECT update to the server, if it can.

See <a href="https://Shirakumo.github.io/lichat-protocol/#CLASS%20LICHAT-PROTOCOL%3ADISCONNECT" class="xref">LICHAT-PROTOCOL:DISCONNECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:CONNECTION-OPEN-P"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ACONNECTION-OPEN-P">CONNECTION-OPEN-P</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CLIENT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:HANDLE-CONNECTION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AHANDLE-CONNECTION">HANDLE-CONNECTION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CLIENT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Handles the incoming updates from the server.

This repeatedly (while the stream is open) calls READ-MESSAGE
and then passes that message on to PROCESS. If a connection
stability error occurs during this (timout, shutdown, reset, etc)
then HANDLE-FATAL-ERROR is called.

A restart called CLOSE-CONNECTION is active during this, which
allows you to gracefully exit and close the connection.

See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3APROCESS" class="xref">PROCESS</a>
See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AHANDLE-FATAL-ERROR" class="xref">HANDLE-FATAL-ERROR</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:HANDLE-FATAL-ERROR"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AHANDLE-FATAL-ERROR">HANDLE-FATAL-ERROR</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CLIENT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>This function is used to handle a fatal, aborting connection error.

You can use this to either simply close and exit, or to try
and reestablish a new connection.

See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AHANDLE-CONNECTION" class="xref">HANDLE-CONNECTION</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:HOSTNAME"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AHOSTNAME">HOSTNAME</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the TCP hostname the client is connecting to.

See <a href="#CLASS%20LICHAT-TCP-CLIENT%3ACLIENT" class="xref">CLIENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:(SETF HOSTNAME)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3A%28SETF%20HOSTNAME%29">(SETF HOSTNAME)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:OPEN-CONNECTION"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AOPEN-CONNECTION">OPEN-CONNECTION</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CLIENT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Initiate the connection from the client to the connection.

Implements the proper connection procedure as mandated by the
protocol in ยง4.1. If the connection fails, for whatever reason,
an error is signalled. If the connection succeeds, a background
thread is started that calls HANDLE-CONNECTION.

See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AHANDLE-CONNECTION" class="xref">HANDLE-CONNECTION</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:PASSWORD"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3APASSWORD">PASSWORD</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the password of the client, if any.

See <a href="#CLASS%20LICHAT-TCP-CLIENT%3ACLIENT" class="xref">CLIENT</a>
See <a href="https://Shirakumo.github.io/lichat-protocol/#GENERIC-FUNCTION%20LICHAT-PROTOCOL%3APASSWORD" class="xref">LICHAT-PROTOCOL:PASSWORD</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:(SETF PASSWORD)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3A%28SETF%20PASSWORD%29">(SETF PASSWORD)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:PORT"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3APORT">PORT</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the TCP port the client is connecting over.

See <a href="#CLASS%20LICHAT-TCP-CLIENT%3ACLIENT" class="xref">CLIENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:(SETF PORT)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3A%28SETF%20PORT%29">(SETF PORT)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:PROCESS"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3APROCESS">PROCESS</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument">CLIENT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>This method is intended to be extended by user code and is called with any update received from the server.

Default methods exist for the following update types:
 * LICHAT-PROTOCOL:PING       -- Automatically replies to the server
                                 with a LICHAT-PROTOCOL:PONG update.
 * LICHAT-PROTOCOL:DISCONNECT -- Invoke the CLOSE-CONNECTION restart.
 * T                          -- Print the object via Verbose.

See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AHANDLE-CONNECTION" class="xref">HANDLE-CONNECTION</a>
See <a href="https://Shirakumo.github.io/lichat-protocol/#CLASS%20LICHAT-PROTOCOL%3APING" class="xref">LICHAT-PROTOCOL:PING</a>
See <a href="https://Shirakumo.github.io/lichat-protocol/#CLASS%20LICHAT-PROTOCOL%3ADISCONNECT" class="xref">LICHAT-PROTOCOL:DISCONNECT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:READ-MESSAGE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AREAD-MESSAGE">READ-MESSAGE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CLIENT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Reads wireables from the client's stream until one can be read successfully.

This is to say, it will repeatedly try to read a message,
ignoring all LICHAT-PROTOCOL:WIRE-CONDITIONs until one can
be read without such an error. The message is returned.

See <a href="https://Shirakumo.github.io/lichat-protocol/#TYPE%20LICHAT-PROTOCOL%3AWIREABLE" class="xref">LICHAT-PROTOCOL:WIREABLE</a>
See <a href="https://Shirakumo.github.io/lichat-protocol/#FUNCTION%20LICHAT-PROTOCOL%3AFROM-WIRE" class="xref">LICHAT-PROTOCOL:FROM-WIRE</a>
See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ASOCKET-STREAM" class="xref">SOCKET-STREAM</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:SEND"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ASEND">SEND</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument">CLIENT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Send an update over the client connection to the server.

See <a href="https://Shirakumo.github.io/lichat-protocol/#FUNCTION%20LICHAT-PROTOCOL%3ATO-WIRE" class="xref">LICHAT-PROTOCOL:TO-WIRE</a>
See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ASOCKET-STREAM" class="xref">SOCKET-STREAM</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:SOCKET"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ASOCKET">SOCKET</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the USOCKET:SOCKET instance that connects to the server.

See <a href="#CLASS%20LICHAT-TCP-CLIENT%3ACLIENT" class="xref">CLIENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:(SETF SOCKET)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3A%28SETF%20SOCKET%29">(SETF SOCKET)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:THREAD"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ATHREAD">THREAD</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the background processing thread of the client.

See <a href="#CLASS%20LICHAT-TCP-CLIENT%3ACLIENT" class="xref">CLIENT</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:(SETF THREAD)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3A%28SETF%20THREAD%29">(SETF THREAD)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:URL"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AURL">URL</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">CLIENT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:USERNAME"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3AUSERNAME">USERNAME</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><pre>Accessor to the username of the client.

See <a href="#CLASS%20LICHAT-TCP-CLIENT%3ACLIENT" class="xref">CLIENT</a>
See <a href="https://Shirakumo.github.io/lichat-protocol/#TYPE%20LICHAT-PROTOCOL%3AUSERNAME" class="xref">LICHAT-PROTOCOL:USERNAME</a></pre></div> </article> </li>  <li> <article class="definition generic-function callable" id="GENERIC-FUNCTION LICHAT-TCP-CLIENT:(SETF USERNAME)"> <header> <span class="visibility">EXTERNAL</span> <span class="type">GENERIC-FUNCTION</span> <h4 class="name"> <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3A%28SETF%20USERNAME%29">(SETF USERNAME)</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <li class="argument">NEW-VALUE</li>    <li class="argument">OBJECT</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  </header> <div class="docstring"><i>No documentation provided.</i></div> </article> </li>  <li> <article class="definition macro callable" id="MACRO-FUNCTION LICHAT-TCP-CLIENT:WITH-RESPONSE"> <header> <span class="visibility">EXTERNAL</span> <span class="type">MACRO</span> <h4 class="name"> <a href="#MACRO-FUNCTION%20LICHAT-TCP-CLIENT%3AWITH-RESPONSE">WITH-RESPONSE</a> </h4> <ul class="qualifiers"></ul> <ul class="arguments">  <ul class="arguments"> <li class="argument">MESSAGE</li>  <li class="argument">CLIENT</li>  <li class="argument lambda-list-keyword">&amp;REST</li> </ul>    <li class="argument">INIT</li>    <li class="argument lambda-list-keyword">&amp;BODY</li>    <li class="argument">BODY</li>    <li class="argument lambda-list-keyword">&amp;REST</li>  </ul>  <a class="source-link" href="https://github.com/Shirakumo/lichat-tcp-client/blob/5343d37e71c48fe2db6885200bb3599822012d19/client.lisp#L50">Source</a>  </header> <div class="docstring"><pre>Shorthand macro to await a response from the server that matches the update generated in the INIT form.

See <a href="#GENERIC-FUNCTION%20LICHAT-TCP-CLIENT%3ACALL-WITH-RESPONSE" class="xref">CALL-WITH-RESPONSE</a></pre></div> </article> </li> </ul> </article> </li> </ul> </section>  </article> <script>window.addEventListener("DOMContentLoaded", function(){
    var unmarkElement = function(el){
        if(el.tagName === "mark" || el.tagName === "MARK"){
            [].forEach.call(el.childNodes, function(child){
                el.parentNode.insertBefore(child, el);
            });
            el.parentNode.removeChild(el);
        }else if(el.parentNode.tagName === "mark"){
            return unmarkElement(el.parentNode);
        }
        return null;
    }

    var unmarkAll = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("mark"), unmarkElement);
    }
    
    var markElement = function(el){
        if(el.parentNode.tagName === "mark" || el.parentNode.tagName === "MARK"){
            return el.parentNode;
        } else {
            unmarkAll();
            var marked = document.createElement("mark");
            el.parentNode.insertBefore(marked, el);
            marked.appendChild(el);
            return marked;
        }
    }

    var markFragmented = function(){
        if(window.location.hash){
            var el = document.getElementById(decodeURIComponent(window.location.hash.substr(1)));
            if(el) markElement(el);
        }
    }

    var registerXrefLink = function(link){
        var el = document.getElementById(decodeURIComponent(link.getAttribute("href").substr(1)));
        if(el){
            link.addEventListener("click", function(){
                markElement(el);
            });
        }
    }

    var registerXrefLinks = function(root){
        root = root || document;
        [].forEach.call(root.querySelectorAll("a.xref"), registerXrefLink);
    }

    markFragmented();
    registerXrefLinks();
}); </script> </body> </html> 